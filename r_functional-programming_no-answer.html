<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
<!-- 2018-04-16 Mon 14:33 -->
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Functional programming in R (with purrr)</title>
<meta name="generator" content="Org mode" />
<meta name="author" content="Marie-Hélène Burle" />
<style type="text/css">
<!--/*--><![CDATA[/*><!--*/
@media all
{
  article,
  aside,
  details,
  figcaption,
  figure,
  footer,
  header,
  hgroup,
  nav,
  section,
  summary {
    display: block;
  }
  audio,
  canvas,
  video {
    display: inline-block;
  }
  audio:not([controls]) {
    display: none;
    height: 0;
  }
  [hidden] {
    display: none;
  }
  html {
    font-family: sans-serif;
    -webkit-text-size-adjust: 95%;
    -ms-text-size-adjust: 95%;
  }
  body {
    margin: 0;
  }
  a:focus {
    outline: thin dotted;
  }
  a:active,
  a:hover {
    outline: 0;
  }
  abbr[title] {
    border-bottom: 1px dotted;
  }
  b,
  strong {
    font-weight: bold;
  }
  dfn {
    font-style: italic;
  }
  mark {
    background: #ff0;
    color: #000;
  }
  code,
  kbd,
  pre,
  samp {
    font-family: monospace, serif;
    font-size: 1em;
  }
  pre,
  code {
    white-space: pre-wrap;
    word-wrap: break-word;
  }
  q {
    quotes: "\201C" "\201D" "\2018" "\2019";
  }
  small {
    font-size: 80%; 
  }
  sub,
  sup {
    font-size: 75%;
    line-height: 0;
    position: relative;
    vertical-align: baseline;
  }
  sup {
    top: -0.5em;
  }
  sub {
    bottom: -0.25em;
  }
  img {
    border: 0;
  }
  svg:not(:root) {
    overflow: hidden;
  }
  figure {
    margin: 0;
  }
  fieldset {
    border: 1px solid #c0c0c0;
    margin: 0 2px;
    padding: 0.35em 0.625em 0.75em;
  }
  legend {
    border: 0;
    padding: 0;
  }
  button,
  input,
  select,
  textarea {
    font-family: inherit;
    font-size: 100%;
    margin: 0;
  }
  button,
  input {
    line-height: normal;
  }
  button,
  html input[type="button"],
  input[type="reset"],
  input[type="submit"] {
    -webkit-appearance: button;
    cursor: pointer;
  }
  button[disabled],
  input[disabled] {
    cursor: default;
  }
  input[type="checkbox"],
  input[type="radio"] {
    box-sizing: border-box;
    padding: 0;
  }
  input[type="search"] {
    -webkit-appearance: textfield;
    -moz-box-sizing: content-box;
    -webkit-box-sizing: content-box;
    box-sizing: content-box;
  }
  input[type="search"]::-webkit-search-cancel-button,
  input[type="search"]::-webkit-search-decoration {
    -webkit-appearance: none;
  }
  button::-moz-focus-inner,
  input::-moz-focus-inner {
    border: 0;
    padding: 0;
  }
  textarea {
    overflow: auto;
    vertical-align: top;
  }
  table {
    border-collapse: collapse;
    border-spacing: 0;
  }
  html {
    font-family: 'Lato', sans-serif;
    font-size: 110%;
  }
  pre,
  code {
    font-family: 'Inconsolata', sans-serif;
  }
  h1,
  h2,
  h3,
  h4,
  h5,
  h6 {
    font-family: 'Lato', sans-serif;
    font-weight: 700;
  }
  h1 {
    line-height: 50px;
    padding: 20px 0px 10px 0px;
  }
  h2 {
    line-height: 35px;
    padding: 20px 0px 0px 0px;
  }
  h3 {
    line-height: 31px;
    padding: 15px 0px 0px 0px;
  }
  h4 {
    line-height: 25px;
  }
  h5 {
    line-height: 20px;    
  }
  h6 {
    line-height: 15px;
  }
  html {
    background-color: #faf9f1;
    color: #242b2f;
    margin: 1em;
    line-height: 24px;
  }
  body {
    background-color: #faf9f1;
    margin: 0px auto 0px 150px;
    max-width: 21.5cm;
    /* border: 1pt solid #93a1a1; */
    /* border: 1pt solid #d9d9d9; */
    /* border: 1pt solid #c9cfcf; */
    /* border-radius: 10px; */
    padding: 1em;
  } 
  a {
    color: #b58900;
  }
  a:visited {
    color: #cb4b16;
  }
  a:hover {
    color: #e65719;
  }
  h1 {
    color: #890c0c;
  }
  h2 {
    color: #19334d;
  }
  h3 {
    color: #336699;
  }
  h4 {
    color: #6699cc;
  }
  h5 {
    color: #666666;
  }
  h6 {
    color: #808080;
  }
  pre[class="src src-R"] {	/*for blocks src R*/
    background-color: #f1f1f1;
    color: #262626;
    padding: 0.8em;
    font-size: 95%;
    line-height: 22px;
    border: 0.5pt solid #d9d9d9;
    border-radius: 5px;
    box-shadow: 0pt 0pt 0pt #eee8d5;
  }
  code {			/*for inline code*/
    background-color: #f1f1f1;
    color: #262626;
    padding: 0em 0.2em 0em 0.2em;
    font-size: 95%;
    line-height: 22px;
    border: 0.5pt solid #e6e6e6;
    border-radius: 3px;
    box-shadow: 0pt 0pt 0pt #eee8d5;
  }
  blockquote {			/*for block quote*/
    /* font: 14px/22px normal helvetica, sans-serif; /\*original line*\/ */
    line-height: 22px;
    font-style: italic;
    margin: 30px 0px 30px 50px;
    padding-left: 15px;
    border-left: 3px solid #ccc;
  }
  pre[class="example"] {	/*for block example*/
    background-color: #f0efe7;
    font-family: 'Rokkitt';
    width: max-content;
    color: #3e3e3e;
    padding: 0.6em 0.8em 0.6em 0.8em;
    /* font-size: 95%; */
    line-height: 22px;
    border: 0.5pt solid #ebeae0;
    border-radius: 5px;
    box-shadow: 0pt 0pts 0pt #eee8d5;
  }
  p[class="verse"] {		/*for block verse*/
    color: #262626;
    font-family: 'IM Fell English';
    font-size: 110%;
    font-style: italic;
    /* margin-left: 30px;		/\*keep this line to have the verses indented*\/ */
    line-height: 25px;
  }
  div[class="org-center"] {	/*for block center*/
    margin: auto;
    line-height: 22px;
    width: max-content;
  }
  div[class="ASCII"] {		/*for block center*/
    font-family: 'Montez';
    line-height: 26px;
    font-size: 130%;
  }
  div[class="VERBATIM"] {	/*for block center*/
    /* background-color: #f5f4eb; */
    font-family: 'Anonymous Pro';
    margin: auto;
    width: max-content;
    color: #000000;
    /* padding: 0.05em 0.8em 0.05em 0.8em; */
    font-size: 88%;
    line-height: 20px;
    /* border: 0.5pt solid #d9d9d9; */
    /* border-radius: 5px; */
  }
  .org-ess-numbers {
    color: #e28200; 
  }
  .org-comment-delimiter {
    color: #8c8c8c;
  }
  .org-comment {
    color: #8c8c8c;
  }
  .org-string {
    color: #013b6d;
  }
  .org-ess-function-call {
    color: #bf4040;
    /* font-weight: bolder; */
  }
  .org-ess-operator {
    color: #0b5e56;
  }
  .org-ess-assignment {
    color: #0b5e56;
  }
  .org-ess-paren {
    color: #0b5e56;
  }
  .org-ess-XopX {
    color: #0b5e56;
  }  
  h1 {
    font-size: 2.2em;
    text-align: center;
  }
  h2 {
    font-size: 1.6em;
  }
  h3 {
    font-size: 1.5em;
  }
  h4 {
    font-size: 1.4em;
  }
  h5 {
    font-size: 1.3em;
  }
  h6 {
    font-size: 1.2em;
  }
  .tag {
    background-color: #eee8d5;
    color: #d33682;
    padding: 0 0.2em;
  }
  .todo,
  .next,
  .done {
    color: #faf9f1;
    background-color: #dc322f;
    padding: 0 0.2em;
  }
  .tag {
    -webkit-border-radius: 0.35em;
    -moz-border-radius: 0.35em;
    border-radius: 0.35em;
  }
  .TODO {
    -webkit-border-radius: 0.2em;
    -moz-border-radius: 0.2em;
    border-radius: 0.2em;
    background-color: #2aa198;
  }
  .NEXT {
    -webkit-border-radius: 0.2em;
    -moz-border-radius: 0.2em;
    border-radius: 0.2em;
    background-color: #268bd2;
  }
  .ACTIVE {
    -webkit-border-radius: 0.2em;
    -moz-border-radius: 0.2em;
    border-radius: 0.2em;
    background-color: #268bd2;
  }
  .DONE {
    -webkit-border-radius: 0.2em;
    -moz-border-radius: 0.2em;
    border-radius: 0.2em;
    background-color: #859900;
  }
  .WAITING {
    -webkit-border-radius: 0.2em;
    -moz-border-radius: 0.2em;
    border-radius: 0.2em;
    background-color: #cb4b16;
  }
  .HOLD {
    -webkit-border-radius: 0.2em;
    -moz-border-radius: 0.2em;
    border-radius: 0.2em;
    background-color: #d33682;
  }
  .NOTE {
    -webkit-border-radius: 0.2em;
    -moz-border-radius: 0.2em;
    border-radius: 0.2em;
    background-color: #d33682;
  }
  .CANCELLED {
    -webkit-border-radius: 0.2em;
    -moz-border-radius: 0.2em;
    border-radius: 0.2em;
    background-color: #859900;
  }

  /* TOC inspired by http://jashkenas.github.com/coffee-script */
  #table-of-contents {
    font-size: 10pt;
    position: fixed;
    right: 0em;
    top: 0em;
    background: #faf9f1;
    color: #596a73;
    /* -webkit-box-shadow: 0 0 1em #777777; */
    /* -moz-box-shadow: 0 0 1em #777777; */
    /* -webkit-border-bottom-left-radius: 10px; */
    /* -moz-border-radius-bottomleft: 10px; */
    text-align: right;
    /* ensure doesn't flow off the screen when expanded */
    max-height: 80%;
    overflow: auto;
  }
  #table-of-contents h2 {
    font-size: 12pt;
    max-width: 25em;
    font-weight: bold;
    color: #596a73;
    padding-right: 3em;
    padding-left: 0.8em;
    padding-top: 1em;
    padding-bottom: 0em;
    text-align: left;
  }
  #table-of-contents #text-table-of-contents {
    display: none;
    text-align: left;
  }
  #table-of-contents:hover #text-table-of-contents {
    display: block;
    padding: 0.5em;
    margin-top: -1.5em;
  }

  .rss_box {}
  .rss_title, rss_title a {}
  .rss_items {}
  .rss_item a:link, .rss_item a:visited, .rss_item a:active {}
  .rss_item a:hover {}
  .rss_date {}

} /* END OF @media all */


@media screen
{
  #table-of-contents {
    float: right;
    border: 0px solid #CCC;
    max-width: 25%;
    overflow: auto;
  }
} /* END OF @media screen */
/*]]>*/-->
</style>
<script type="text/javascript">
/*
@licstart  The following is the entire license notice for the
JavaScript code in this tag.

Copyright (C) 2012-2018 Free Software Foundation, Inc.

The JavaScript code in this tag is free software: you can
redistribute it and/or modify it under the terms of the GNU
General Public License (GNU GPL) as published by the Free Software
Foundation, either version 3 of the License, or (at your option)
any later version.  The code is distributed WITHOUT ANY WARRANTY;
without even the implied warranty of MERCHANTABILITY or FITNESS
FOR A PARTICULAR PURPOSE.  See the GNU GPL for more details.

As additional permission under GNU GPL version 3 section 7, you
may distribute non-source (e.g., minimized or compacted) forms of
that code without the copy of the GNU GPL normally required by
section 4, provided you include this license notice and a URL
through which recipients can access the Corresponding Source.


@licend  The above is the entire license notice
for the JavaScript code in this tag.
*/
<!--/*--><![CDATA[/*><!--*/
 function CodeHighlightOn(elem, id)
 {
   var target = document.getElementById(id);
   if(null != target) {
     elem.cacheClassElem = elem.className;
     elem.cacheClassTarget = target.className;
     target.className = "code-highlighted";
     elem.className   = "code-highlighted";
   }
 }
 function CodeHighlightOff(elem, id)
 {
   var target = document.getElementById(id);
   if(elem.cacheClassElem)
     elem.className = elem.cacheClassElem;
   if(elem.cacheClassTarget)
     target.className = elem.cacheClassTarget;
 }
/*]]>*///-->
</script>
</head>
<body>
<div id="preamble" class="status">
<span style="color:#596a73; font-size:16px"><b>Marie-Hélène Burle</b><br>April 16, 2018</span>
</div>
<div id="content">
<h1 class="title">Functional programming in R (with purrr)</h1>
<div id="table-of-contents">
<h2>Table of Contents</h2>
<div id="text-table-of-contents">
<ul>
<li><a href="#org6e8e71c">1. Introduction</a>
<ul>
<li><a href="#orgdae2b54">1.1. What is functional programming?</a></li>
<li><a href="#org99630d4">1.2. Iterations</a></li>
<li><a href="#org9b8f819">1.3. The purrr package</a>
<ul>
<li><a href="#org48fe885">1.3.1. Goal</a></li>
<li><a href="#orgb1f322c">1.3.2. Logistics</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#org75da2ff">2. Let's dive in</a>
<ul>
<li><a href="#org8eedf1f">2.1. Load packages</a></li>
<li><a href="#orge4b7ab7">2.2. Create some fake banding data</a></li>
<li><a href="#org7b6da06">2.3. Modify: modify elements of a list</a>
<ul>
<li><a href="#orgc4cbe78">2.3.1. Usage</a></li>
<li><a href="#org33604ba">2.3.2. Apply to our example</a></li>
<li><a href="#org9c52dea">2.3.3. Magrittr digression: less used piping treasures</a></li>
</ul>
</li>
<li><a href="#org16dc0e4">2.4. Map: apply functions to elements of a list</a>
<ul>
<li><a href="#org8cfbd46">2.4.1. Usage</a></li>
<li><a href="#org60aa4c3">2.4.2. Apply to our example</a></li>
</ul>
</li>
<li><a href="#org90b03e1">2.5. Walk: apply side effects to elements of a list</a>
<ul>
<li><a href="#org94640e9">2.5.1. Usage</a></li>
<li><a href="#orga8cabc8">2.5.2. Apply to our example</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#orgb7ed185">3. Your turn!</a>
<ul>
<li><a href="#org2935fc3">3.1. Create new fake data</a></li>
<li><a href="#orgfe5b06d">3.2. Apply functions to each variable</a></li>
</ul>
</li>
<li><a href="#orgcbe5e07">4. Summary of the map functions family</a>
<ul>
<li><a href="#orgdb6297e">4.1. How many lists we are using in the input</a></li>
<li><a href="#orgb5d6715">4.2. The class of the output we want</a></li>
<li><a href="#org3b39c5e">4.3. How we want to select the input</a></li>
</ul>
</li>
<li><a href="#org0b62e42">5. Formulas: a shorter notation for anonymous functions</a>
<ul>
<li><a href="#orga0c7dbe">5.1. Referring to elements</a></li>
</ul>
</li>
<li><a href="#org0ccf10d">6. Nested data frames</a></li>
<li><a href="#org13923a8">7. Conclusion</a></li>
</ul>
</div>
</div>

<div id="outline-container-org6e8e71c" class="outline-2">
<h2 id="org6e8e71c"><span class="section-number-2">1</span> Introduction</h2>
<div class="outline-text-2" id="text-1">
</div>
<div id="outline-container-orgdae2b54" class="outline-3">
<h3 id="orgdae2b54"><span class="section-number-3">1.1</span> What is functional programming?</h3>
<div class="outline-text-3" id="text-1-1">
<p>
It is a programming paradigm based on the evaluation of functions. This is opposed to <i>imperative  programming</i>. Some languages are based strictly on functional programming (e.g. Haskell), others<br />
</p>
</div>
</div>

<div id="outline-container-org99630d4" class="outline-3">
<h3 id="org99630d4"><span class="section-number-3">1.2</span> Iterations</h3>
<div class="outline-text-3" id="text-1-2">
<p>
Repetition of a process (e.g. applying the same function to several variables).<br />
</p>

<p>
Classic methods:<br />
</p>
<ul class="org-ul">
<li>loops<br /></li>
<li><code class="src src-R">apply</code> functions family<br /></li>
</ul>
</div>
</div>

<div id="outline-container-org9b8f819" class="outline-3">
<h3 id="org9b8f819"><span class="section-number-3">1.3</span> The purrr package</h3>
<div class="outline-text-3" id="text-1-3">
<p>
One of the <code class="src src-R">tidyverse</code> core packages, <code class="src src-R">purrr</code> was written a few years ago by <a href="https://github.com/lionel-">Lionel Henry</a> (also the maintainer), <a href="http://hadley.nz/">Hadley Wickham</a>, and <a href="https://www.rstudio.com/">RStudio inc.</a> <br />
</p>
</div>

<div id="outline-container-org48fe885" class="outline-4">
<h4 id="org48fe885"><span class="section-number-4">1.3.1</span> Goal</h4>
<div class="outline-text-4" id="text-1-3-1">
<p>
<code class="src src-R">Purrr</code> is a set of tools allowing consistent functional programming in R in a <code class="src src-R">tidyverse</code> style (using <code class="src src-R">magrittr</code> pipes and following the same naming conventions found in other <code class="src src-R">tidyverse</code> packages).<br />
</p>

<p>
As Hadley Wickham says, in many ways, <code class="src src-R">purrr</code> is the equivalent of the <code class="src src-R">dplyr</code>, but while <code class="src src-R">dplyr</code> focuses on data frames, <code class="src src-R">purrr</code> works on vectors: it works on the elements of atomic vectors, lists, and data frames.<br />
</p>
</div>
</div>

<div id="outline-container-orgb1f322c" class="outline-4">
<h4 id="orgb1f322c"><span class="section-number-4">1.3.2</span> Logistics</h4>
<div class="outline-text-4" id="text-1-3-2">
<p>
Install it with:<br />
</p>

<div class="org-src-container">
<pre class="src src-R"><span class="org-ess-function-call">install.packages</span><span class="org-ess-paren"><span class="org-rainbow-delimiters-depth-1">(</span></span><span class="org-string">"tidyverse"</span><span class="org-ess-paren"><span class="org-rainbow-delimiters-depth-1">)</span></span>
<span class="org-comment-delimiter">## </span><span class="org-comment">or</span>
<span class="org-ess-function-call">install.packages</span><span class="org-ess-paren"><span class="org-rainbow-delimiters-depth-1">(</span></span><span class="org-string">"purrr"</span><span class="org-ess-paren"><span class="org-rainbow-delimiters-depth-1">)</span></span>
</pre>
</div>

<p>
Load it with:<br />
</p>

<div class="org-src-container">
<pre class="src src-R"><span class="org-ess-modifiers">library</span><span class="org-ess-paren"><span class="org-rainbow-delimiters-depth-1">(</span></span>tidyverse<span class="org-ess-paren"><span class="org-rainbow-delimiters-depth-1">)</span></span>
<span class="org-comment-delimiter">## </span><span class="org-comment">or</span>
<span class="org-ess-modifiers">library</span><span class="org-ess-paren"><span class="org-rainbow-delimiters-depth-1">(</span></span>purrr<span class="org-ess-paren"><span class="org-rainbow-delimiters-depth-1">)</span></span>
</pre>
</div>

<p>
As always, once the package is loaded, you can get information on the package with:<br />
</p>

<div class="org-src-container">
<pre class="src src-R">?purrr
</pre>
</div>

<p>
and on any of its functions with:<br />
</p>

<div class="org-src-container">
<pre class="src src-R">?<span class="org-ess-keyword">function</span>

<span class="org-comment-delimiter">## </span><span class="org-comment">e.g. for the map function</span>
?map
</pre>
</div>
</div>
</div>
</div>
</div>

<div id="outline-container-org75da2ff" class="outline-2">
<h2 id="org75da2ff"><span class="section-number-2">2</span> Let's dive in</h2>
<div class="outline-text-2" id="text-2">
</div>
<div id="outline-container-org8eedf1f" class="outline-3">
<h3 id="org8eedf1f"><span class="section-number-3">2.1</span> Load packages</h3>
<div class="outline-text-3" id="text-2-1">
<p>
First, let's load the packages that we will use. It is always a good idea to write all the packages that you will be using at the top of the script. This will help others, using your script, to know what is required to run it.<br />
</p>

<div class="org-src-container">
<pre class="src src-R"><span class="org-ess-modifiers">library</span><span class="org-ess-paren"><span class="org-rainbow-delimiters-depth-1">(</span></span>tidyverse<span class="org-ess-paren"><span class="org-rainbow-delimiters-depth-1">)</span></span>   <span class="org-comment-delimiter"># </span><span class="org-comment">we will use purrr and other core packages</span>
<span class="org-ess-modifiers">library</span><span class="org-ess-paren"><span class="org-rainbow-delimiters-depth-1">(</span></span>magrittr<span class="org-ess-paren"><span class="org-rainbow-delimiters-depth-1">)</span></span>    <span class="org-comment-delimiter"># </span><span class="org-comment">we will use several types of pipes</span>
<span class="org-ess-modifiers">library</span><span class="org-ess-paren"><span class="org-rainbow-delimiters-depth-1">(</span></span>patchwork<span class="org-ess-paren"><span class="org-rainbow-delimiters-depth-1">)</span></span>   <span class="org-comment-delimiter"># </span><span class="org-comment">this is a cool package to plot several graphs together</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-orge4b7ab7" class="outline-3">
<h3 id="orge4b7ab7"><span class="section-number-3">2.2</span> Create some fake banding data</h3>
<div class="outline-text-3" id="text-2-2">
<p>
Let's create some imaginary bird banding data:<br />
</p>

<div class="org-src-container">
<pre class="src src-R">banding <span class="org-ess-assignment">&lt;-</span> <span class="org-ess-function-call">data.frame</span><span class="org-ess-paren"><span class="org-rainbow-delimiters-depth-1">(</span></span>
  bird <span class="org-ess-operator">=</span> <span class="org-ess-function-call">paste0</span><span class="org-ess-paren"><span class="org-rainbow-delimiters-depth-2">(</span></span><span class="org-string">"bird"</span>, <span class="org-ess-numbers">1</span>:<span class="org-ess-numbers">50</span><span class="org-ess-paren"><span class="org-rainbow-delimiters-depth-2">)</span></span>,
  sex <span class="org-ess-operator">=</span> <span class="org-ess-function-call">sample</span><span class="org-ess-paren"><span class="org-rainbow-delimiters-depth-2">(</span></span><span class="org-ess-function-call">c</span><span class="org-ess-paren"><span class="org-rainbow-delimiters-depth-3">(</span></span><span class="org-string">"F"</span>, <span class="org-string">"M"</span><span class="org-ess-paren"><span class="org-rainbow-delimiters-depth-3">)</span></span>, <span class="org-ess-numbers">50</span>, replace <span class="org-ess-operator">=</span> <span class="org-ess-f-t">T</span><span class="org-ess-paren"><span class="org-rainbow-delimiters-depth-2">)</span></span>,
  population <span class="org-ess-operator">=</span> <span class="org-ess-function-call">sample</span><span class="org-ess-paren"><span class="org-rainbow-delimiters-depth-2">(</span></span>LETTERS<span class="org-ess-paren"><span class="org-rainbow-delimiters-depth-3">[</span></span><span class="org-ess-numbers">1</span>:<span class="org-ess-numbers">3</span><span class="org-ess-paren"><span class="org-rainbow-delimiters-depth-3">]</span></span>, <span class="org-ess-numbers">50</span>, replace <span class="org-ess-operator">=</span> <span class="org-ess-f-t">T</span><span class="org-ess-paren"><span class="org-rainbow-delimiters-depth-2">)</span></span>,
  mass <span class="org-ess-operator">=</span> <span class="org-ess-function-call">rnorm</span><span class="org-ess-paren"><span class="org-rainbow-delimiters-depth-2">(</span></span><span class="org-ess-numbers">50</span>, <span class="org-ess-numbers">43</span>, <span class="org-ess-numbers">4</span><span class="org-ess-paren"><span class="org-rainbow-delimiters-depth-2">)</span></span>,
  tarsus <span class="org-ess-operator">=</span> <span class="org-ess-function-call">rnorm</span><span class="org-ess-paren"><span class="org-rainbow-delimiters-depth-2">(</span></span><span class="org-ess-numbers">50</span>, <span class="org-ess-numbers">27</span>, <span class="org-ess-numbers">1</span><span class="org-ess-paren"><span class="org-rainbow-delimiters-depth-2">)</span></span>,
  wing <span class="org-ess-operator">=</span> <span class="org-ess-function-call">rnorm</span><span class="org-ess-paren"><span class="org-rainbow-delimiters-depth-2">(</span></span><span class="org-ess-numbers">50</span>, <span class="org-ess-numbers">112</span>, <span class="org-ess-numbers">3</span><span class="org-ess-paren"><span class="org-rainbow-delimiters-depth-2">)</span></span>
<span class="org-ess-paren"><span class="org-rainbow-delimiters-depth-1">)</span></span>

banding

banding <span class="org-ess-XopX">%&gt;%</span> <span class="org-ess-function-call">str</span><span class="org-ess-paren"><span class="org-rainbow-delimiters-depth-1">()</span></span>
</pre>
</div>
</div>
</div>

<div id="outline-container-org7b6da06" class="outline-3">
<h3 id="org7b6da06"><span class="section-number-3">2.3</span> Modify: modify elements of a list</h3>
<div class="outline-text-3" id="text-2-3">
<p>
As is the case with data frames, we can see that the 3 string variables (bird, sex, and population) have been converted to factors. What if we decide to convert all those factors into character vectors.<br />
</p>

<p>
<b>How would you do this? Spend 5 minutes writing code you would usually use.</b><br />
</p>

<p>
To modify the elements of a list, you can use the modify functions family:<br />
</p>
</div>

<div id="outline-container-orgc4cbe78" class="outline-4">
<h4 id="orgc4cbe78"><span class="section-number-4">2.3.1</span> Usage</h4>
<div class="outline-text-4" id="text-2-3-1">
<div class="org-src-container">
<pre class="src src-R"><span class="org-ess-function-call">modify</span><span class="org-ess-paren"><span class="org-rainbow-delimiters-depth-1">(</span></span>.x, .f, ...<span class="org-ess-paren"><span class="org-rainbow-delimiters-depth-1">)</span></span>
<span class="org-ess-function-call">modify_if</span><span class="org-ess-paren"><span class="org-rainbow-delimiters-depth-1">(</span></span>.x, .p, .f, ...<span class="org-ess-paren"><span class="org-rainbow-delimiters-depth-1">)</span></span>
<span class="org-ess-function-call">modify_at</span><span class="org-ess-paren"><span class="org-rainbow-delimiters-depth-1">(</span></span>.x, .at, .f, ...<span class="org-ess-paren"><span class="org-rainbow-delimiters-depth-1">)</span></span>
</pre>
</div>

<pre class="example">
.x     a list or atomic vector
.f     a function, formula, or atomic vector
...    additional arguments passed to .f
.p     a predicate function.
       Only the elements for which .p evaluates to TRUE will be modified
.at    a character vector of names or a numeric vector of positions.
       Only the elements corresponding to .at will be modified
</pre>
</div>
</div>

<div id="outline-container-org33604ba" class="outline-4">
<h4 id="org33604ba"><span class="section-number-4">2.3.2</span> Apply to our example</h4>
<div class="outline-text-4" id="text-2-3-2">
<p>
Now, this is how all factors in our data frame can be converted into character vectors using <code class="src src-R"><span class="org-ess-function-call">modify_if</span><span class="org-ess-paren"><span class="org-rainbow-delimiters-depth-1">()</span></span></code>:<br />
</p>

<p>
The modify family includes <code class="src src-R"><span class="org-ess-function-call">modify</span><span class="org-ess-paren"><span class="org-rainbow-delimiters-depth-1">()</span></span></code>, <code class="src src-R"><span class="org-ess-function-call">modify_if</span><span class="org-ess-paren"><span class="org-rainbow-delimiters-depth-1">()</span></span></code>, <code class="src src-R"><span class="org-ess-function-call">modify_at</span><span class="org-ess-paren"><span class="org-rainbow-delimiters-depth-1">()</span></span></code>, and <code class="src src-R">modify_depth</code>. That last one will make sense later.<br />
</p>

<blockquote>
<p>
Wait: what were all these weird looking pipes??<br />
</p>
</blockquote>
</div>
</div>

<div id="outline-container-org9c52dea" class="outline-4">
<h4 id="org9c52dea"><span class="section-number-4">2.3.3</span> Magrittr digression: less used piping treasures</h4>
<div class="outline-text-4" id="text-2-3-3">
<p>
<code class="src src-R"><span class="org-ess-XopX">%&lt;&gt;%</span></code> pipes the left expression to the right, and then back to the left. Instead of a right arrow, think of it as an arrow going from left to right, making a turn and going back to its starting place again.<br />
</p>

<p>
The code<br />
</p>

<div class="org-src-container">
<pre class="src src-R">banding <span class="org-ess-XopX">%&lt;&gt;%</span>
  <span class="org-ess-function-call">modify_if</span><span class="org-ess-paren"><span class="org-rainbow-delimiters-depth-1">(</span></span>is.factor, as.character<span class="org-ess-paren"><span class="org-rainbow-delimiters-depth-1">)</span></span> <span class="org-ess-XopX">%T&gt;%</span>
  <span class="org-ess-function-call">str</span><span class="org-ess-paren"><span class="org-rainbow-delimiters-depth-1">()</span></span>
</pre>
</div>

<p>
that we used above, is equivalent to<br />
</p>

<div class="org-src-container">
<pre class="src src-R">banding <span class="org-ess-assignment">&lt;-</span>
  banding <span class="org-ess-XopX">%&gt;%</span>
  <span class="org-ess-function-call">modify_if</span><span class="org-ess-paren"><span class="org-rainbow-delimiters-depth-1">(</span></span>is.factor, as.character<span class="org-ess-paren"><span class="org-rainbow-delimiters-depth-1">)</span></span> <span class="org-ess-XopX">%T&gt;%</span>
  <span class="org-ess-function-call">str</span><span class="org-ess-paren"><span class="org-rainbow-delimiters-depth-1">()</span></span>
</pre>
</div>

<p>
<code class="src src-R"><span class="org-ess-XopX">%T%</span></code> pipes the effect of the left expression to the right, but does not pipe the object itself (so the object is "free" to be used by another pipe). This is very useful when you want to produce to output from one object. Or produce a side effect (e.g. printing) without interrupting a pipeline. I like to think of the "T" as a branching which represents the 2 outputs produced by a single object.<br />
</p>

<p>
Try replacing <code class="src src-R"><span class="org-ess-XopX">%T%</span></code> with the regular pipe <code class="src src-R"><span class="org-ess-XopX">%&gt;%</span></code> in our code and see what happens. Can you explain it?<br />
</p>

<p>
There are other pipes in <a href="https://github.com/tidyverse/magrittr">this amazing package</a>. You should explore them at your own time!<br />
</p>
</div>
</div>
</div>

<div id="outline-container-org16dc0e4" class="outline-3">
<h3 id="org16dc0e4"><span class="section-number-3">2.4</span> Map: apply functions to elements of a list</h3>
<div class="outline-text-3" id="text-2-4">
<p>
Now, let's imagine that we want to plot the effect of tarsus length on mass, but that we want to graph each population separately.<br />
</p>

<p>
<b>How would you do this? Spend 5 minutes writing code you would usually use.</b><br />
</p>

<p>
To apply functions to elements of a list, you can use the <code class="src src-R">map</code> functions family:<br />
</p>
</div>

<div id="outline-container-org8cfbd46" class="outline-4">
<h4 id="org8cfbd46"><span class="section-number-4">2.4.1</span> Usage</h4>
<div class="outline-text-4" id="text-2-4-1">
<div class="org-src-container">
<pre class="src src-R"><span class="org-ess-function-call">map</span><span class="org-ess-paren"><span class="org-rainbow-delimiters-depth-1">(</span></span>.x, .f, ...<span class="org-ess-paren"><span class="org-rainbow-delimiters-depth-1">)</span></span>
<span class="org-ess-function-call">map_if</span><span class="org-ess-paren"><span class="org-rainbow-delimiters-depth-1">(</span></span>.x, .p, .f, ...<span class="org-ess-paren"><span class="org-rainbow-delimiters-depth-1">)</span></span>
<span class="org-ess-function-call">map_at</span><span class="org-ess-paren"><span class="org-rainbow-delimiters-depth-1">(</span></span>.x, .at, .f, ...<span class="org-ess-paren"><span class="org-rainbow-delimiters-depth-1">)</span></span>
</pre>
</div>

<pre class="example">
.x     a list or atomic vector
.f     a function, formula, or atomic vector
...     additional arguments passed to .f
.p     a predicate function.
       Only the elements for which .p evaluates to TRUE will be modified
.at    a character vector of names or a numeric vector of positions.
       Only the elements corresponding to .at will be modified
</pre>
</div>
</div>

<div id="outline-container-org60aa4c3" class="outline-4">
<h4 id="org60aa4c3"><span class="section-number-4">2.4.2</span> Apply to our example</h4>
<div class="outline-text-4" id="text-2-4-2">
<p>
This is how we can do this, using <code class="src src-R"><span class="org-ess-function-call">map</span><span class="org-ess-paren"><span class="org-rainbow-delimiters-depth-1">()</span></span></code>:<br />
</p>

<div class="org-src-container">
<pre class="src src-R">graphs <span class="org-ess-assignment">&lt;-</span>
  banding <span class="org-ess-XopX">%&gt;%</span>
  <span class="org-ess-function-call">split</span><span class="org-ess-paren"><span class="org-rainbow-delimiters-depth-1">(</span></span>.$population<span class="org-ess-paren"><span class="org-rainbow-delimiters-depth-1">)</span></span> <span class="org-ess-XopX">%&gt;%</span>
  <span class="org-ess-function-call">map</span><span class="org-ess-paren"><span class="org-rainbow-delimiters-depth-1">(</span></span>~ <span class="org-ess-function-call">ggplot</span><span class="org-ess-paren"><span class="org-rainbow-delimiters-depth-2">(</span></span>., <span class="org-ess-function-call">aes</span><span class="org-ess-paren"><span class="org-rainbow-delimiters-depth-3">(</span></span>tarsus, mass<span class="org-ess-paren"><span class="org-rainbow-delimiters-depth-3">)</span></span><span class="org-ess-paren"><span class="org-rainbow-delimiters-depth-2">)</span></span> <span class="org-ess-operator">+</span> <span class="org-ess-function-call">geom_point</span><span class="org-ess-paren"><span class="org-rainbow-delimiters-depth-2">()</span></span><span class="org-ess-paren"><span class="org-rainbow-delimiters-depth-1">)</span></span>
</pre>
</div>

<p>
And using the amazingly easily package <a href="https://github.com/thomasp85/patchwork">patchwork</a>, we can plot them all side by side very easily with:<br />
</p>

<div class="org-src-container">
<pre class="src src-R">graphs<span class="org-ess-paren"><span class="org-rainbow-delimiters-depth-1">[</span></span><span class="org-ess-paren"><span class="org-rainbow-delimiters-depth-2">[</span></span><span class="org-ess-numbers">1</span><span class="org-ess-paren"><span class="org-rainbow-delimiters-depth-2">]</span></span><span class="org-ess-paren"><span class="org-rainbow-delimiters-depth-1">]</span></span> <span class="org-ess-operator">+</span> graphs<span class="org-ess-paren"><span class="org-rainbow-delimiters-depth-1">[</span></span><span class="org-ess-paren"><span class="org-rainbow-delimiters-depth-2">[</span></span><span class="org-ess-numbers">2</span><span class="org-ess-paren"><span class="org-rainbow-delimiters-depth-2">]</span></span><span class="org-ess-paren"><span class="org-rainbow-delimiters-depth-1">]</span></span> <span class="org-ess-operator">+</span> graphs<span class="org-ess-paren"><span class="org-rainbow-delimiters-depth-1">[</span></span><span class="org-ess-paren"><span class="org-rainbow-delimiters-depth-2">[</span></span><span class="org-ess-numbers">3</span><span class="org-ess-paren"><span class="org-rainbow-delimiters-depth-2">]</span></span><span class="org-ess-paren"><span class="org-rainbow-delimiters-depth-1">]</span></span>
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-org90b03e1" class="outline-3">
<h3 id="org90b03e1"><span class="section-number-3">2.5</span> Walk: apply side effects to elements of a list</h3>
<div class="outline-text-3" id="text-2-5">
<p>
Now that we have our 3 graphs, we want to save them to 3 files.<br />
</p>

<p>
<b>How would you do this? Spend 5 minutes writing code you would usually use.</b><br />
</p>

<p>
To apply side effects to elements of a list, we use the <code class="src src-R">walk</code> functions family:<br />
</p>
</div>

<div id="outline-container-org94640e9" class="outline-4">
<h4 id="org94640e9"><span class="section-number-4">2.5.1</span> Usage</h4>
<div class="outline-text-4" id="text-2-5-1">
<div class="org-src-container">
<pre class="src src-R"><span class="org-ess-function-call">walk</span><span class="org-ess-paren"><span class="org-rainbow-delimiters-depth-1">(</span></span>.x, .f, ...<span class="org-ess-paren"><span class="org-rainbow-delimiters-depth-1">)</span></span>
</pre>
</div>

<pre class="example">
.x     a list or atomic vector
.f     a function, formula, or atomic vector
...     additional arguments passed to .f
</pre>
</div>
</div>

<div id="outline-container-orga8cabc8" class="outline-4">
<h4 id="orga8cabc8"><span class="section-number-4">2.5.2</span> Apply to our example</h4>
<div class="outline-text-4" id="text-2-5-2">
<p>
We already have a list of graphs: <code class="src src-R">graphs</code>. Now, we can create a list of paths where we want to save them:<br />
</p>

<div class="org-src-container">
<pre class="src src-R">paths <span class="org-ess-assignment">&lt;-</span> <span class="org-ess-function-call">paste0</span><span class="org-ess-paren"><span class="org-rainbow-delimiters-depth-1">(</span></span><span class="org-string">"population_"</span>, <span class="org-ess-function-call">names</span><span class="org-ess-paren"><span class="org-rainbow-delimiters-depth-2">(</span></span>graphs<span class="org-ess-paren"><span class="org-rainbow-delimiters-depth-2">)</span></span>, <span class="org-string">".png"</span><span class="org-ess-paren"><span class="org-rainbow-delimiters-depth-1">)</span></span>
</pre>
</div>

<p>
So we want to save each element of <code class="src src-R">graph</code> (a graph) into an element of <code class="src src-R">paths</code> (a path). The function we will use is <code class="src src-R">ggsave</code>. To apply it to all of our elements, instead of using <code class="src src-R">map</code>, we will use <code class="src src-R">walk</code> because we are not trying to create a new object.<br />
</p>

<p>
The problem is that we have 2 lists to deal with. <code class="src src-R">Map</code> and <code class="src src-R">walk</code> only allow to deal with one list. But <code class="src src-R">map2</code> and <code class="src src-R">walk2</code> allow to deal with 2 lists (<code class="src src-R">pmap</code> and <code class="src src-R">pwalk</code> allow to deal with any number of lists).<br />
</p>

<p>
Here is how <code class="src src-R">walk2</code> works (it is the same for <code class="src src-R">map2</code>):<br />
</p>

<div class="org-src-container">
<pre class="src src-R"><span class="org-ess-function-call">walk2</span><span class="org-ess-paren"><span class="org-rainbow-delimiters-depth-1">(</span></span>.x, .y, .f, ...<span class="org-ess-paren"><span class="org-rainbow-delimiters-depth-1">)</span></span>
</pre>
</div>

<pre class="example">
.x, .y   vectors of the same length.
         A vector of length 1 will be recycled.
.f       a function, formula, or atomic vector
...       additional arguments passed to .f
</pre>

<p>
<b>Give it a try! Try to write a function using <code class="src src-R">walk2</code> that will allow us to save the elements of <code class="src src-R">graphs</code> into the elements of <code class="src src-R">paths</code> using <code class="src src-R">ggsave</code>. Don't hesitate to look up the help file for <code class="src src-R">ggsave</code> with <code class="src src-R">?ggsave</code> if you don't remember how to use it!</b><br />
</p>
</div>
</div>
</div>
</div>

<div id="outline-container-orgb7ed185" class="outline-2">
<h2 id="orgb7ed185"><span class="section-number-2">3</span> Your turn!</h2>
<div class="outline-text-2" id="text-3">
</div>
<div id="outline-container-org2935fc3" class="outline-3">
<h3 id="org2935fc3"><span class="section-number-3">3.1</span> Create new fake data</h3>
<div class="outline-text-3" id="text-3-1">
<p>
This time, imagine that bird1 to bird5 are kept in captivity. Their mass is monitored regularly to make sure they are not loosing weight.<br />
</p>

<p>
How can we create such data?<br />
</p>

<p>
We could, of course, write it a tedious way:<br />
</p>

<div class="org-src-container">
<pre class="src src-R">mass <span class="org-ess-assignment">&lt;-</span> <span class="org-ess-function-call">data.frame</span><span class="org-ess-paren"><span class="org-rainbow-delimiters-depth-1">(</span></span>
  bird1 <span class="org-ess-operator">=</span> <span class="org-ess-function-call">runif</span><span class="org-ess-paren"><span class="org-rainbow-delimiters-depth-2">(</span></span><span class="org-ess-numbers">15</span>, <span class="org-ess-numbers">35</span>, <span class="org-ess-numbers">55</span><span class="org-ess-paren"><span class="org-rainbow-delimiters-depth-2">)</span></span> <span class="org-ess-XopX">%&gt;%</span> <span class="org-ess-function-call">round</span><span class="org-ess-paren"><span class="org-rainbow-delimiters-depth-2">(</span></span><span class="org-ess-numbers">1</span><span class="org-ess-paren"><span class="org-rainbow-delimiters-depth-2">)</span></span>,
  bird2 <span class="org-ess-operator">=</span> <span class="org-ess-function-call">runif</span><span class="org-ess-paren"><span class="org-rainbow-delimiters-depth-2">(</span></span><span class="org-ess-numbers">15</span>, <span class="org-ess-numbers">35</span>, <span class="org-ess-numbers">55</span><span class="org-ess-paren"><span class="org-rainbow-delimiters-depth-2">)</span></span> <span class="org-ess-XopX">%&gt;%</span> <span class="org-ess-function-call">round</span><span class="org-ess-paren"><span class="org-rainbow-delimiters-depth-2">(</span></span><span class="org-ess-numbers">1</span><span class="org-ess-paren"><span class="org-rainbow-delimiters-depth-2">)</span></span>,
  bird3 <span class="org-ess-operator">=</span> <span class="org-ess-function-call">runif</span><span class="org-ess-paren"><span class="org-rainbow-delimiters-depth-2">(</span></span><span class="org-ess-numbers">15</span>, <span class="org-ess-numbers">35</span>, <span class="org-ess-numbers">55</span><span class="org-ess-paren"><span class="org-rainbow-delimiters-depth-2">)</span></span> <span class="org-ess-XopX">%&gt;%</span> <span class="org-ess-function-call">round</span><span class="org-ess-paren"><span class="org-rainbow-delimiters-depth-2">(</span></span><span class="org-ess-numbers">1</span><span class="org-ess-paren"><span class="org-rainbow-delimiters-depth-2">)</span></span>,
  bird4 <span class="org-ess-operator">=</span> <span class="org-ess-function-call">runif</span><span class="org-ess-paren"><span class="org-rainbow-delimiters-depth-2">(</span></span><span class="org-ess-numbers">15</span>, <span class="org-ess-numbers">35</span>, <span class="org-ess-numbers">55</span><span class="org-ess-paren"><span class="org-rainbow-delimiters-depth-2">)</span></span> <span class="org-ess-XopX">%&gt;%</span> <span class="org-ess-function-call">round</span><span class="org-ess-paren"><span class="org-rainbow-delimiters-depth-2">(</span></span><span class="org-ess-numbers">1</span><span class="org-ess-paren"><span class="org-rainbow-delimiters-depth-2">)</span></span>,
  bird5 <span class="org-ess-operator">=</span> <span class="org-ess-function-call">runif</span><span class="org-ess-paren"><span class="org-rainbow-delimiters-depth-2">(</span></span><span class="org-ess-numbers">15</span>, <span class="org-ess-numbers">35</span>, <span class="org-ess-numbers">55</span><span class="org-ess-paren"><span class="org-rainbow-delimiters-depth-2">)</span></span> <span class="org-ess-XopX">%&gt;%</span> <span class="org-ess-function-call">round</span><span class="org-ess-paren"><span class="org-rainbow-delimiters-depth-2">(</span></span><span class="org-ess-numbers">1</span><span class="org-ess-paren"><span class="org-rainbow-delimiters-depth-2">)</span></span>
<span class="org-ess-paren"><span class="org-rainbow-delimiters-depth-1">)</span></span>
</pre>
</div>

<p>
But Hadley Wickham's rule is that we should never copy-paste more than twice. Uh hum&#x2026; we have 5 copies of the same line of code already :P And if we wanted to create a larger data frame, we could have many more than that!<br />
</p>

<p>
<b>Using the <code class="src src-R"><span class="org-ess-function-call">map</span><span class="org-ess-paren"><span class="org-rainbow-delimiters-depth-1">()</span></span></code> function to get to the same result, how would you do this? Spend 5 min brainstorming on this and feel free to talk to each other!</b><br />
</p>
</div>
</div>

<div id="outline-container-orgfe5b06d" class="outline-3">
<h3 id="orgfe5b06d"><span class="section-number-3">3.2</span> Apply functions to each variable</h3>
<div class="outline-text-3" id="text-3-2">
<p>
How could you calculate the mean for each bird?<br />
</p>

<p>
<b>Spend 3 min to think about how to do this using <code class="src src-R"><span class="org-ess-function-call">map</span><span class="org-ess-paren"><span class="org-rainbow-delimiters-depth-1">()</span></span></code>. Feel free to chat with whoever you'd like to.</b><br />
</p>

<p>
Similarly, you can calculate the variance, the sum, look for the largest value, or apply any other function to our data.<br />
</p>

<p>
<b>Spend 2 min writing codes for these.</b><br />
</p>
</div>
</div>
</div>

<div id="outline-container-orgcbe5e07" class="outline-2">
<h2 id="orgcbe5e07"><span class="section-number-2">4</span> Summary of the map functions family</h2>
<div class="outline-text-2" id="text-4">
<p>
We will use different <code class="src src-R">map</code> (or <code class="src src-R">walk</code>, if we want the side effects) function depending on:<br />
</p>
</div>

<div id="outline-container-orgdb6297e" class="outline-3">
<h3 id="orgdb6297e"><span class="section-number-3">4.1</span> How many lists we are using in the input</h3>
<div class="outline-text-3" id="text-4-1">
<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-right" />

<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<thead>
<tr>
<th align="left">number of arguments in input</th>
<th align="left">&#xa0;</th>
<th align="left">&#xa0;</th>
<th align="left">purrr function</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-right">1</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left"><code>map</code> or <code>walk</code></td>
</tr>

<tr>
<td class="org-right">2</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left"><code>map2</code> or <code>walk2</code></td>
</tr>

<tr>
<td class="org-right">more</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left"><code>pmap</code> or <code>pwalk</code></td>
</tr>
</tbody>
</table>
</div>
</div>

<div id="outline-container-orgb5d6715" class="outline-3">
<h3 id="orgb5d6715"><span class="section-number-3">4.2</span> The class of the output we want</h3>
<div class="outline-text-3" id="text-4-2">
<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<thead>
<tr>
<th align="left">class we want for the output</th>
<th align="left">&#xa0;</th>
<th align="left">&#xa0;</th>
<th align="left">purrr function</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-left">list</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left"><code>map</code></td>
</tr>

<tr>
<td class="org-left">double</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left"><code>map_dbl</code></td>
</tr>

<tr>
<td class="org-left">integer</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left"><code>map_int</code></td>
</tr>

<tr>
<td class="org-left">character</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left"><code>map_chr</code></td>
</tr>

<tr>
<td class="org-left">logical</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left"><code>map_lgl</code></td>
</tr>

<tr>
<td class="org-left">data frame (by row-binding)</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left"><code>map_dfr</code></td>
</tr>

<tr>
<td class="org-left">data frame (by column-binding)</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left"><code>map_dfc</code></td>
</tr>
</tbody>
</table>
</div>
</div>

<div id="outline-container-org3b39c5e" class="outline-3">
<h3 id="org3b39c5e"><span class="section-number-3">4.3</span> How we want to select the input</h3>
<div class="outline-text-3" id="text-4-3">
<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<thead>
<tr>
<th align="left">selecting input based on</th>
<th align="left">&#xa0;</th>
<th align="left">&#xa0;</th>
<th align="left">purrr function</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-left">condition</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left"><code>map_if</code></td>
</tr>

<tr>
<td class="org-left">location</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left"><code>map_at</code></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>

<div id="outline-container-org0b62e42" class="outline-2">
<h2 id="org0b62e42"><span class="section-number-2">5</span> Formulas: a shorter notation for anonymous functions</h2>
<div class="outline-text-2" id="text-5">
<p>
With one element<br />
</p>

<div class="org-src-container">
<pre class="src src-R"><span class="org-ess-keyword">function</span><span class="org-ess-paren"><span class="org-rainbow-delimiters-depth-1">(</span></span>x<span class="org-ess-paren"><span class="org-rainbow-delimiters-depth-1">)</span></span> x <span class="org-ess-operator">+</span> <span class="org-ess-numbers">3</span>
</pre>
</div>

<p>
can be written as:<br />
</p>

<div class="org-src-container">
<pre class="src src-R">~ . <span class="org-ess-operator">+</span> <span class="org-ess-numbers">3</span>
</pre>
</div>

<p>
<b>Your turn: write the following anonymous function as a formula</b><br />
</p>

<div class="org-src-container">
<pre class="src src-R"><span class="org-ess-keyword">function</span><span class="org-ess-paren"><span class="org-rainbow-delimiters-depth-1">(</span></span>x<span class="org-ess-paren"><span class="org-rainbow-delimiters-depth-1">)</span></span> <span class="org-ess-function-call">mean</span><span class="org-ess-paren"><span class="org-rainbow-delimiters-depth-1">(</span></span>x<span class="org-ess-paren"><span class="org-rainbow-delimiters-depth-1">)</span></span> <span class="org-ess-operator">+</span> <span class="org-ess-numbers">3</span>
</pre>
</div>

<p>
With 2 elements:<br />
</p>

<div class="org-src-container">
<pre class="src src-R"><span class="org-ess-keyword">function</span><span class="org-ess-paren"><span class="org-rainbow-delimiters-depth-1">(</span></span>x, y<span class="org-ess-paren"><span class="org-rainbow-delimiters-depth-1">)</span></span> x <span class="org-ess-operator">+</span> y
</pre>
</div>

<p>
can be shortened to:<br />
</p>

<div class="org-src-container">
<pre class="src src-R">~ .x <span class="org-ess-operator">+</span> .y
</pre>
</div>
</div>

<div id="outline-container-orga0c7dbe" class="outline-3">
<h3 id="orga0c7dbe"><span class="section-number-3">5.1</span> Referring to elements</h3>
<div class="outline-text-3" id="text-5-1">
<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<thead>
<tr>
<th align="left">1st element</th>
<th align="left">&#xa0;</th>
<th align="left">2nd element</th>
<th align="left">&#xa0;</th>
<th align="left">3rd element</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-left"><code>.</code></td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left"><code>.x</code></td>
<td class="org-left">&#xa0;</td>
<td class="org-left"><code>.y</code></td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left"><code>..1</code></td>
<td class="org-left">&#xa0;</td>
<td class="org-left"><code>..2</code></td>
<td class="org-left">&#xa0;</td>
<td class="org-left"><code>..3</code></td>
</tr>
</tbody>
</table>

<p>
etc.<br />
</p>

<p>
<b>Your turn: write the following anonymous function as a formula</b><br />
</p>

<div class="org-src-container">
<pre class="src src-R"><span class="org-ess-keyword">function</span><span class="org-ess-paren"><span class="org-rainbow-delimiters-depth-1">(</span></span>x1, x2, y<span class="org-ess-paren"><span class="org-rainbow-delimiters-depth-1">)</span></span> <span class="org-ess-function-call">lm</span><span class="org-ess-paren"><span class="org-rainbow-delimiters-depth-1">(</span></span>y ~ x1 <span class="org-ess-operator">+</span> x2<span class="org-ess-paren"><span class="org-rainbow-delimiters-depth-1">)</span></span>
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-org0ccf10d" class="outline-2">
<h2 id="org0ccf10d"><span class="section-number-2">6</span> Nested data frames</h2>
<div class="outline-text-2" id="text-6">
<p>
A nested data frame is a data frame of data frames: some of the cells of this master data frame contains data frames as values. Of course, there is no limit to that and you can have data frames nested within data frames nested within data frames nested within&#x2026; you get the idea. This leads to the concept of "depth".<br />
</p>

<div class="org-src-container">
<pre class="src src-R">
</pre>
</div>
</div>
</div>

<div id="outline-container-org13923a8" class="outline-2">
<h2 id="org13923a8"><span class="section-number-2">7</span> Conclusion</h2>
<div class="outline-text-2" id="text-7">
<p>
These are the most important <code class="src src-R">purrr</code> functions. But there are others that you should explore :)<br />
</p>
</div>
</div>
</div>
</body>
</html>
